Excel.LaunchExcel.LaunchAndOpenUnderExistingProcess Path: $'''C:\\users\\asus\\OneDrive\\Documents\\info.xlsx''' Visible: True ReadOnly: False UseMachineLocale: False Instance=> ExcelInstance
Excel.ReadFromExcel.ReadAllCells Instance: ExcelInstance GetCellContentsMode: Excel.GetCellContentsMode.FormattedTextValues FirstLineIsHeader: True RangeValue=> ExcelData
Excel.CloseExcel.Close Instance: ExcelInstance
LOOP FOREACH CurrentItem IN ExcelData
    WebAutomation.LaunchEdge.LaunchEdge Url: CurrentItem['JobURL'] WindowState: WebAutomation.BrowserWindowState.Maximized ClearCache: False ClearCookies: False WaitForPageToLoadTimeout: 60 Timeout: 60 TargetDesktop: $'''{\"DisplayName\":\"Local computer\",\"Route\":{\"ServerType\":\"Local\",\"ServerAddress\":\"\"},\"DesktopType\":\"local\"}''' BrowserInstance=> Browser
    Display.ShowMessageDialog.ShowMessage Title: $'''Action needed''' Message: $'''I\'ve opened the job page. Please navigate to the \'Personal Info\' form. Once the form is fully loaded, press OK to continue.''' Icon: Display.Icon.Information Buttons: Display.Buttons.OK DefaultButton: Display.DefaultButton.Button1 IsTopMost: False ButtonPressed=> ButtonPressed
    WebAutomation.ExecuteJavascript BrowserInstance: Browser Javascript: $'''function fillField(keywords, value) {
    // 1. Convert keywords string (e.g., \"first name,given name,fname\") into an array
    const searchTerms = keywords.toLowerCase().split(\',\');
    
    // Helper function to check if any keyword matches
    function matches(text) {
        if (!text) return false;
        const lowerText = text.toLowerCase();
        return searchTerms.some(term => lowerText.includes(term));
    }

    try {
        // 2. Try to find by <label>
        const labels = Array.from(document.querySelectorAll(\'label\'));
        for (const label of labels) {
            if (matches(label.innerText)) {
                // Found a matching label. Now find its input.
                // Case A: <label for=\"xyz\">
                const forId = label.getAttribute(\'for\');
                if (forId) {
                    const input = document.getElementById(forId);
                    if (input) {
                        input.value = value;
                        input.dispatchEvent(new Event(\'input\', { bubbles: true })); // Trigger change events
                        input.dispatchEvent(new Event(\'change\', { bubbles: true }));
                        return `Success: Filled by label \'for\' attribute: ${label.innerText}`;
                    }
                }
                
                // Case B: <label>...<input>...</label>
                const inputInside = label.querySelector(\'input, textarea, select\');
                if (inputInside) {
                    inputInside.value = value;
                    inputInside.dispatchEvent(new Event(\'input\', { bubbles: true }));
                    inputInside.dispatchEvent(new Event(\'change\', { bubbles: true }));
                    return `Success: Filled input inside label: ${label.innerText}`;
                }
            }
        }
        
        // 3. If label search fails, try to find by input attributes
        const inputs = Array.from(document.querySelectorAll(\'input[type=\"text\"], input[type=\"email\"], input[type=\"tel\"], textarea, input:not([type])\'));
        for (const input of inputs) {
            if (matches(input.placeholder) || matches(input.name) || matches(input.id) || matches(input.getAttribute(\'aria-label\'))) {
                input.value = value;
                input.dispatchEvent(new Event(\'input\', { bubbles: true }));
                input.dispatchEvent(new Event(\'change\', { bubbles: true }));
                return `Success: Filled by input attribute (placeholder, name, id, or aria-label)`;
            }
        }
        
        return \"Error: Could not find a matching field.\";

    } catch (e) {
        return `Error: ${e.message}`;
    }
}''' Result=> Result
    WebAutomation.ExecuteJavascript BrowserInstance: Browser Javascript: $'''fillField(\'first name,given name,fname,first_name\', \'%CurrentItem['FirstName']%\');
fillField(\'last name,surname,lname,last_name\', \'%CurrentItem['LastName']%\');
fillField(\'email,e-mail,email address\', \'%CurrentItem['Email']%\');
fillField(\'phone,mobile,tel,contact number\', \'%CurrentItem['Phone']%\');''' Result=> Result2
    Display.ShowMessageDialog.ShowMessage Title: $'''Automation Paused''' Message: $'''I\'ve filled in the basics. Please take over and complete the rest of the application (like custom questions, resume upload, etc.). Press OK when you are finished with this job and ready to move to the next one.''' Icon: Display.Icon.None Buttons: Display.Buttons.OK DefaultButton: Display.DefaultButton.Button1 IsTopMost: False ButtonPressed=> ButtonPressed2
    WebAutomation.CloseWebBrowser BrowserInstance: Browser
END
